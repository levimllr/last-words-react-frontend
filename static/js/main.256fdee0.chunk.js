(this["webpackJsonplast-words-react-frontend"]=this["webpackJsonplast-words-react-frontend"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(7),o=n.n(r),i=(n(13),n(1)),c=n(2),l=n(4),h=n(3),d=n(5),m=function(e){return s.a.createElement("button",{onClick:e.clickAction},e.btnTxt)},u=function(e){return s.a.createElement("div",null,s.a.createElement("h2",null,"Definition"),s.a.createElement("p",{className:"field definitionField"},e.text))},p=function(e){return s.a.createElement("div",null,s.a.createElement("h3",null,"Total Score: ",e.totalScore))};function f(e){var t;return 0===e?t="purple":1===e?t="blue":2===e?t="green":3===e?t="gold":4===e?t="orange":5===e&&(t="red"),t}var g=function(e){return s.a.createElement("li",{style:{color:f(e.misses.length)}},e.name)},v=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderGameWords",value:function(){var e;if(0===this.props.gameWords.length)e=Array(7).fill([s.a.createElement("br",{key:"blank"})]);else if((e=this.props.gameWords.map((function(e){return s.a.createElement(g,{key:e.word,name:e.word,misses:e.misses})}))).length<7)for(var t=1;e.length<7;)e.push(s.a.createElement("br",{key:"blank-".concat(t)})),t+=1;return e.slice(-7)}},{key:"listStart",value:function(){return this.props.gameWords.length<=7?1:this.props.gameWords.length-7}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h1",null,this.props.highScore?"High Score!":"Last Words"),s.a.createElement("ol",{start:this.listStart()},this.renderGameWords()),s.a.createElement(p,{totalScore:this.props.totalScore}))}}]),t}(s.a.Component),w=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).state={userNameArray:["_","_","_"]},n.handleClickOutside=function(e){"modal"===e.target.className&&n.props.modalOnClick()},n.handleKeyPress=function(e){document.getElementById("gameModalHeader").classList.add("missing");var t=e.key.toLowerCase(),a=n.state.userNameArray,s=a.indexOf("_");13!==e.keyCode&&(8===e.keyCode?-1===s?a[2]="_":a[s-1]="_":e.keyCode>=65&&e.keyCode<=90&&(a[s]=t.toUpperCase()),n.setState({userNameArray:a}))},n.handleOnClick=function(e){n.state.userNameArray.includes("_")||(window.removeEventListener("keydown",n.handleKeyPress),n.props.handleNewPlayer(n.state.userNameArray))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.handleClickOutside),window.addEventListener("keydown",this.handleKeyPress),document.getElementById("gameModalHeader").addEventListener("transitionend",this.props.removeTransition)}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("newGameButton");e&&e.focus()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClickOutside)}},{key:"render",value:function(){return this.props.show?s.a.createElement("div",{className:"modal"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("h1",{className:"modal-header",id:"gameModalHeader"},"Any last words, ",this.state.userNameArray.join(" ")," ?"),this.state.userNameArray.includes("_")?s.a.createElement("h3",null,"Press any letter on your keyboard."):s.a.createElement("button",{id:"newGameButton",onClick:this.handleOnClick},"Face your fate."))):null}}]),t}(s.a.Component),y=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.getElementById("scaffoldImg").addEventListener("transitionend",this.props.removeTransition)}},{key:"render",value:function(){var e="/img/Hangman-".concat(this.props.misses,".png"),t="Hangman with ".concat(this.props.misses," of 6 misses");return s.a.createElement("div",null,s.a.createElement("img",{id:"scaffoldImg",src:e,alt:t}))}}]),t}(s.a.Component),S=function(e){return s.a.createElement("div",null,s.a.createElement("h2",null,"Word"),s.a.createElement("p",{className:"field"},e.status))},k=function(e){return s.a.createElement("div",{className:"preField"},s.a.createElement("h3",null,e.statName),s.a.createElement("p",{className:"field"},e.status))};var E=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).state={wordScreen:[],wordArray:[],hits:[],misses:[],wordDone:!1},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.handleAttempt=this.handleAttempt.bind(this)}},{key:"componentDidUpdate",value:function(){if(0!==Object.keys(this.props.word).length&&this.props.word.name!==this.state.wordArray.join("")){var e=this.props.word.name.split(""),t=function(e){var t=[];return e.forEach((function(e){var n;(n=e).toLowerCase()!==n.toUpperCase()?t.push("_"):t.push(e)})),t}(e);this.props.listening?window.addEventListener("keypress",this.handleAttempt):window.removeEventListener("keypress",this.handleAttempt),this.setState({wordScreen:t,wordArray:e,hits:[],misses:[],wordDone:!1})}}},{key:"handleAttempt",value:function(e){var t=e.key.toLowerCase();13!==e.keyCode&&(console.log(e.keyCode),/[a-zA-Z]/.test(t)&&!1===this.state.wordDone&&(this.state.wordArray.includes(t)?(console.log("Hit!"),this.handleHit(t)):(console.log("Miss!"),this.handleMiss(t))))}},{key:"handleHit",value:function(e){var t=this.state.hits;t.includes(e)||(t.push(e),this.setState({hits:t}),this.revealScreen(e))}},{key:"handleMiss",value:function(e){document.getElementById("scaffoldImg").classList.add("missing");var t=this.state.misses;if(!t.includes(e))return t.push(e),this.setState({misses:t}),6===t.length?(window.removeEventListener("keypress",this.handleAttempt),this.setState({wordScreen:this.state.wordArray}),void this.props.handleLoss()):void 0}},{key:"revealScreen",value:function(e){for(var t=this.state.wordArray,n=this.state.wordScreen,a=0;a<this.state.wordArray.length;a++)e===t[a]&&(n[a]=t[a]);this.setState({wordScreen:n}),this.state.wordArray.join("")===this.state.wordScreen.join("")&&this.props.handleWin(this.state.misses)}},{key:"render",value:function(){var e=0===this.state.wordScreen.length?s.a.createElement("br",null):this.state.wordScreen.join(" "),t=0===this.state.hits.length?s.a.createElement("br",null):this.state.hits.join(" "),n=0===this.state.misses.length?s.a.createElement("br",null):this.state.misses.join(" ");return s.a.createElement("div",{className:"WordInfo"},s.a.createElement(y,{misses:this.state.misses.length,removeTransition:this.props.removeTransition}),s.a.createElement(S,{status:e}),s.a.createElement(k,{statName:"Hits",condition:!0,status:t}),s.a.createElement(k,{statName:"Misses",condition:!1,status:n}))}}]),t}(s.a.Component),O=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).handleClickOutside=function(e){"modal"===e.target.className&&n.props.modalOnClick()},n.formatScore=function(e){var t="".concat(e),n=t.split("");if(t.length<4)for(;n.length<4;)n.unshift("0");return t=n.join("")},n.formatIndex=function(e){return["0TH","1ST","2ND","3RD","4TH","5TH","6TH","7TH","8TH","9TH","10TH"][e+1]},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClickOutside)}},{key:"render",value:function(){var e=this;return this.props.show?s.a.createElement("div",{className:"modal"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("h1",{className:"modal-header",id:"gameModalHeader"},"High Scores"),s.a.createElement("ol",{className:"modal-list"},this.props.highScores.map((function(t,n){return s.a.createElement("li",{className:"modal-list-item",style:{color:f(n)}},e.formatIndex(n),"...",t.username,"...",e.formatScore(t.total_score)," ")}))))):null}}]),t}(s.a.Component),b="https://last-words-on-rails.herokuapp.com",j=b+"/games/high_scores",N=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(s)))).state={showNewGame:!1,showHighScores:!1,allWords:[],gameWords:[],currentWord:{},highScores:[],gameOver:!0,gameId:null,username:"",totalScore:0,listening:!1,highScore:!1},n.removeTransition=function(e){"transform"===e.propertyName&&e.target.classList.remove("missing")},n.showModal=function(e){console.log("Show modal!"),n.setState({listening:!1}),"New Game"===e.target.innerText?n.setState({showNewGame:!0,gameId:null,username:"",totalScore:0}):"High Scores"===e.target.innerText&&n.setState({showHighScores:!0})},n.modalOnClick=function(){console.log("Modal click!"),!0===n.state.showNewGame?n.setState({showNewGame:!1}):!0===n.state.showHighScores&&n.setState({showHighScores:!1})},n.showScores=function(){return console.log("HIGH SCORES!!!")},n.newGame=function(e){var t=e.join("");n.setState({showNewGame:!1,gameOver:!0,gameWords:[],totalScore:0,username:t,highScore:!1});var a=n.state.allWords,s=a.pop();n.postNewGame(t),n.setState({allWords:a,currentWord:s,listening:!0})},n.handleLoss=function(){console.log("You lose."),fetch(j).then((function(e){return e.json()})).then((function(e){return n.setState({highScores:e})})).then((function(){var e=n.state.highScores[n.state.highScores.length-1].total_score;n.state.totalScore>=e&&n.setState({highScore:!0})}))},n.calculateScore=function(e,t){return e.points+e.name.length-2*t.length},n.handleWin=function(e){var t=n.calculateScore(n.state.currentWord,e);console.log("Word Score: ".concat(t));var a={game_id:n.state.gameId,word_id:n.state.currentWord.id,word:n.state.currentWord.name,misses:e.join(""),win:!0};n.postGameWord(a)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchAll()}},{key:"componentDidUpdate",value:function(){!0===this.state.gameOver&&(this.fetchAll(),this.setState({gameOver:!1}))}},{key:"fetchAll",value:function(){var e=this;fetch("https://last-words-on-rails.herokuapp.com/words/random").then((function(e){return e.json()})).then((function(t){return e.setState({allWords:t})})),fetch(j).then((function(e){return e.json()})).then((function(t){return e.setState({highScores:t})}))}},{key:"postNewGame",value:function(e){var t=this,n={username:e,total_score:this.state.totalScore};fetch("https://last-words-on-rails.herokuapp.com/games",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){return t.setState({gameId:e.id,username:e.username})}))}},{key:"postGameWord",value:function(e){var t=this,n="/games/".concat(this.state.gameId,"/game_words");fetch(b+n,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(n){e.score=n.score;var a=t.state.totalScore+e.score;t.setState({totalScore:a})})).then((function(){var n=t.state.gameWords;n.push(e);var a=t.state.allWords,s=a.pop();t.setState({allWords:a,gameWords:n,currentWord:s}),t.updateGame()}))}},{key:"updateGame",value:function(){var e=b+"/games/".concat(this.state.gameId),t={game:{id:this.state.gameId,username:this.state.username,total_score:this.state.totalScore}};fetch(e,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}},{key:"render",value:function(){var e=0===Object.keys(this.state.currentWord).length?s.a.createElement("br",null):this.state.currentWord.major_class+"  "+this.state.currentWord.definition;return s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"column column-left"},s.a.createElement(v,{totalScore:this.state.totalScore,gameWords:this.state.gameWords,highScore:this.state.highScore}),s.a.createElement(u,{text:e}),s.a.createElement(m,{btnTxt:"High Scores",clickAction:this.showModal}),s.a.createElement(m,{btnTxt:"New Game",clickAction:this.showModal})),s.a.createElement("div",{className:"column column-right"},s.a.createElement(E,{word:this.state.currentWord,handleLoss:this.handleLoss,handleWin:this.handleWin,listening:this.state.listening,removeTransition:this.removeTransition})),this.state.showNewGame?s.a.createElement(w,{show:this.state.showNewGame,handleNewPlayer:this.newGame,modalOnClick:this.modalOnClick,removeTransition:this.removeTransition}):"",this.state.showHighScores?s.a.createElement(O,{highScores:this.state.highScores,show:this.state.showHighScores,modalOnClick:this.modalOnClick}):"")}}]),t}(s.a.Component);n(14);var W=function(){return s.a.createElement("div",{className:"App"},s.a.createElement(N,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.256fdee0.chunk.js.map